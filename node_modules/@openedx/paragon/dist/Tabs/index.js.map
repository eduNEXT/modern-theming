{"version":3,"file":"index.js","names":["React","useEffect","useMemo","useRef","useState","useCallback","classNames","PropTypes","BaseTabs","Bubble","Dropdown","useIndexOfLastVisibleChild","Tab","MORE_TAB_TEXT","Tabs","_ref","children","className","moreTabText","defaultActiveKey","activeKey","props","containerElementRef","setContainerElementRef","overflowElementRef","indexOfLastVisibleChild","firstChild","current","parentNode","observer","MutationObserver","mutations","forEach","mutation","eventKey","target","getAttribute","isActive","element","querySelector","moreTab","classList","add","remove","observe","attributes","subtree","attributeFilter","disconnect","undefined","tabIndex","handleDropdownTabClick","hiddenTab","click","tabsChildren","indexOfOverflowStart","handleDropdownKeyPress","e","key","childrenList","Children","map","child","index","type","name","process","env","NODE_ENV","console","error","isValidElement","title","notification","tabClassName","rest","newTitle","createElement","Fragment","variant","role","expandable","tabClass","modifiedTab","cloneElement","moreTabHasNotification","overflowChildren","slice","overflowChild","Item","as","onClick","onKeyPress","disabled","datakey","active","splice","length","ref","Toggle","id","Menu","propTypes","oneOf","node","isRequired","string","defaultProps","default","TabContainer","TabContent","TabPane"],"sources":["../../src/Tabs/index.jsx"],"sourcesContent":["import React, {\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n  useCallback,\n} from 'react';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\nimport BaseTabs from 'react-bootstrap/Tabs';\nimport Bubble from '../Bubble';\nimport Dropdown from '../Dropdown';\nimport useIndexOfLastVisibleChild from '../hooks/useIndexOfLastVisibleChildHook';\nimport Tab from './Tab';\n\nexport const MORE_TAB_TEXT = 'More...';\n\nfunction Tabs({\n  children,\n  className,\n  moreTabText = MORE_TAB_TEXT,\n  defaultActiveKey,\n  activeKey,\n  ...props\n}) {\n  const [containerElementRef, setContainerElementRef] = useState(null);\n  const overflowElementRef = useRef(null);\n  const indexOfLastVisibleChild = useIndexOfLastVisibleChild(\n    containerElementRef?.firstChild,\n    overflowElementRef.current?.parentNode,\n  );\n\n  useEffect(() => {\n    if (containerElementRef) {\n      const observer = new MutationObserver((mutations => {\n        mutations.forEach(mutation => {\n          // React-Bootstrap attribute 'data-rb-event-key' is responsible for the tab identification\n          const eventKey = mutation.target.getAttribute('data-rb-event-key');\n          // React-Bootstrap attribute 'aria-selected' is responsible for selected/unselected state\n          const isActive = mutation.target.getAttribute('aria-selected') === 'true';\n          // datakey attribute is added manually to the dropdown\n          // elements so that they correspond to the native tabs' eventKey\n          const element = containerElementRef.querySelector(`[datakey='${eventKey}']`);\n          const moreTab = containerElementRef.querySelector('.pgn__tab_more');\n          if (isActive) {\n            element?.classList.add('active');\n            // Here we add active class to the 'More Tab' if element exists in the dropdown\n            if (element) {\n              moreTab.classList.add('active');\n            } else {\n              moreTab.classList.remove('active');\n            }\n          } else {\n            element?.classList.remove('active');\n          }\n        });\n      }));\n      observer.observe(containerElementRef, {\n        attributes: true, subtree: true, attributeFilter: ['aria-selected'],\n      });\n      return () => observer.disconnect();\n    }\n    return undefined;\n  }, [containerElementRef]);\n\n  useEffect(() => {\n    if (overflowElementRef.current?.parentNode) {\n      overflowElementRef.current.parentNode.tabIndex = -1;\n    }\n  }, [overflowElementRef.current?.parentNode]);\n\n  const handleDropdownTabClick = useCallback((eventKey) => {\n    const hiddenTab = containerElementRef.querySelector(`[data-rb-event-key='${eventKey}']`);\n    hiddenTab.click();\n  }, [containerElementRef]);\n\n  const tabsChildren = useMemo(() => {\n    const indexOfOverflowStart = indexOfLastVisibleChild + 1;\n    const handleDropdownKeyPress = (e, eventKey) => {\n      if (e.key === 'Enter') {\n        handleDropdownTabClick(eventKey);\n      }\n    };\n    const childrenList = React.Children.map(children, (child, index) => {\n      if (child?.type?.name !== 'Tab' && process.env.NODE_ENV === 'development') {\n        // eslint-disable-next-line no-console\n        console.error(\n          `Tabs children can only be of type Tab. ${children[index]} was passed instead.`,\n        );\n      }\n      if (!React.isValidElement(child)) {\n        return child;\n      }\n      const {\n        title, notification, tabClassName, ...rest\n      } = child.props;\n      let newTitle;\n      if (notification) {\n        newTitle = (\n          <>\n            {title}\n            <Bubble\n              variant=\"error\"\n              role=\"status\"\n              className=\"pgn__tab-notification\"\n              aria-live=\"polite\"\n              expandable\n            >\n              {notification}\n            </Bubble>\n          </>\n        );\n      } else {\n        newTitle = title;\n      }\n      const tabClass = index > indexOfLastVisibleChild ? 'pgn__tab_invisible' : '';\n      const modifiedTab = React.cloneElement(child, {\n        ...rest,\n        title: newTitle,\n        tabClassName: classNames(tabClass, tabClassName),\n      });\n      return modifiedTab;\n    });\n    let moreTabHasNotification = false;\n    const overflowChildren = childrenList.slice(indexOfOverflowStart)\n      .map(overflowChild => {\n        if (!moreTabHasNotification && overflowChild.props.notification) {\n          moreTabHasNotification = true;\n        }\n        return (\n          <Dropdown.Item\n            as=\"li\"\n            tabIndex=\"0\"\n            key={`${overflowChild.props.eventKey}overflow`}\n            onClick={() => handleDropdownTabClick(overflowChild.props.eventKey)}\n            onKeyPress={(e) => handleDropdownKeyPress(e, overflowChild.props.eventKey)}\n            disabled={overflowChild.props.disabled}\n            datakey={overflowChild.props.eventKey}\n            className={classNames({\n              active: overflowChild.props.eventKey === defaultActiveKey || overflowChild.props.eventKey === activeKey,\n            }, 'pgn__tabs__dropdown-item')}\n          >\n            {overflowChild.props.title}\n          </Dropdown.Item>\n        );\n      });\n\n    childrenList.splice(indexOfOverflowStart, 0, (<Tab\n      key=\"moreTabKey\"\n      tabClassName={classNames(!overflowChildren.length && 'pgn__tab_invisible', 'pgn__tab_more')}\n      title={(\n        <Dropdown ref={overflowElementRef}>\n          <Dropdown.Toggle\n            variant=\"link\"\n            className=\"nav-link\"\n            id=\"pgn__tab-toggle\"\n          >\n            {moreTabText}\n            {moreTabHasNotification && (\n              <Bubble\n                variant=\"error\"\n                role=\"status\"\n                className=\"pgn__tab-notification\"\n              />\n            )}\n          </Dropdown.Toggle>\n          <Dropdown.Menu as=\"ul\" className=\"dropdown-menu-right\">{overflowChildren}</Dropdown.Menu>\n        </Dropdown>\n      )}\n    />\n    ));\n    return childrenList;\n  }, [activeKey, children, defaultActiveKey, indexOfLastVisibleChild, moreTabText, handleDropdownTabClick]);\n\n  return (\n    <div ref={setContainerElementRef}>\n      <BaseTabs\n        defaultActiveKey={defaultActiveKey}\n        activeKey={activeKey}\n        {...props}\n        className={classNames(className, 'pgn__tabs')}\n      >\n        {tabsChildren}\n      </BaseTabs>\n    </div>\n  );\n}\n\nTabs.propTypes = {\n  /** Specifies variant to use. */\n  variant: PropTypes.oneOf(['tabs', 'pills', 'inverse-tabs', 'inverse-pills', 'button-group']),\n  /** Specifies elements that is processed to create tabs. */\n  children: PropTypes.node.isRequired,\n  /** Specifies class name to append to the base element. */\n  className: PropTypes.string,\n  /** Specifies text for the 'More' tab. */\n  moreTabText: PropTypes.string,\n  /** Specifies default active tab (uncontrolled usage). */\n  defaultActiveKey: PropTypes.string,\n  /** Specifies active tab (controlled usage). */\n  activeKey: PropTypes.string,\n};\n\nTabs.defaultProps = {\n  variant: 'tabs',\n  className: undefined,\n  moreTabText: MORE_TAB_TEXT,\n  defaultActiveKey: undefined,\n  activeKey: undefined,\n};\n\nexport default Tabs;\nexport { Tab };\nexport { default as TabContainer } from 'react-bootstrap/TabContainer';\nexport { default as TabContent } from 'react-bootstrap/TabContent';\nexport { default as TabPane } from 'react-bootstrap/TabPane';\n"],"mappings":"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","ignoreList":[]}